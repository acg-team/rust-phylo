pub(crate) type ProteinExch = [f64; 400];
pub(crate) type ProteinExchLowerTriangle = [f64; 190];
pub(super) type ProteinFrequencies = [f64; 20];

// AA order matches MrBayes and PhyML
// ARNDCQEGHILKMFPSTWYV

// Full WAG exchangeability matrix from MrBayes
pub(crate) const WAG_EXCH: ProteinExch = [
    0.0000000, 0.5515710, 0.5098480, 0.7389980, 1.0270400, 0.9085980, 1.5828500, 1.4167200,
    0.3169540, 0.1933350, 0.3979150, 0.9062650, 0.8934960, 0.2104940, 1.4385500, 3.3707900,
    2.1211100, 0.1131330, 0.2407350, 2.0060100, 0.5515710, 0.0000000, 0.6353460, 0.1473040,
    0.5281910, 3.0355000, 0.4391570, 0.5846650, 2.1371500, 0.1869790, 0.4976710, 5.3514200,
    0.6831620, 0.1027110, 0.6794890, 1.2241900, 0.5544130, 1.1639200, 0.3815330, 0.2518490,
    0.5098480, 0.6353460, 0.0000000, 5.4294200, 0.2652560, 1.5436400, 0.9471980, 1.1255600,
    3.9562900, 0.5542360, 0.1315280, 3.0120100, 0.1982210, 0.0961621, 0.1950810, 3.9742300,
    2.0300600, 0.0719167, 1.0860000, 0.1962460, 0.7389980, 0.1473040, 5.4294200, 0.0000000,
    0.0302949, 0.6167830, 6.1741600, 0.8655840, 0.9306760, 0.0394370, 0.0848047, 0.4798550,
    0.1037540, 0.0467304, 0.4239840, 1.0717600, 0.3748660, 0.1297670, 0.3257110, 0.1523350,
    1.0270400, 0.5281910, 0.2652560, 0.0302949, 0.0000000, 0.0988179, 0.0213520, 0.3066740,
    0.2489720, 0.1701350, 0.3842870, 0.0740339, 0.3904820, 0.3980200, 0.1094040, 1.4076600,
    0.5129840, 0.7170700, 0.5438330, 1.0021400, 0.9085980, 3.0355000, 1.5436400, 0.6167830,
    0.0988179, 0.0000000, 5.4694700, 0.3300520, 4.2941100, 0.1139170, 0.8694890, 3.8949000,
    1.5452600, 0.0999208, 0.9333720, 1.0288700, 0.8579280, 0.2157370, 0.2277100, 0.3012810,
    1.5828500, 0.4391570, 0.9471980, 6.1741600, 0.0213520, 5.4694700, 0.0000000, 0.5677170,
    0.5700250, 0.1273950, 0.1542630, 2.5844300, 0.3151240, 0.0811339, 0.6823550, 0.7049390,
    0.8227650, 0.1565570, 0.1963030, 0.5887310, 1.4167200, 0.5846650, 1.1255600, 0.8655840,
    0.3066740, 0.3300520, 0.5677170, 0.0000000, 0.2494100, 0.0304501, 0.0613037, 0.3735580,
    0.1741000, 0.0499310, 0.2435700, 1.3418200, 0.2258330, 0.3369830, 0.1036040, 0.1872470,
    0.3169540, 2.1371500, 3.9562900, 0.9306760, 0.2489720, 4.2941100, 0.5700250, 0.2494100,
    0.0000000, 0.1381900, 0.4994620, 0.8904320, 0.4041410, 0.6793710, 0.6961980, 0.7401690,
    0.4733070, 0.2625690, 3.8734400, 0.1183580, 0.1933350, 0.1869790, 0.5542360, 0.0394370,
    0.1701350, 0.1139170, 0.1273950, 0.0304501, 0.1381900, 0.0000000, 3.1709700, 0.3238320,
    4.2574600, 1.0594700, 0.0999288, 0.3194400, 1.4581600, 0.2124830, 0.4201700, 7.8213000,
    0.3979150, 0.4976710, 0.1315280, 0.0848047, 0.3842870, 0.8694890, 0.1542630, 0.0613037,
    0.4994620, 3.1709700, 0.0000000, 0.2575550, 4.8540200, 2.1151700, 0.4158440, 0.3447390,
    0.3266220, 0.6653090, 0.3986180, 1.8003400, 0.9062650, 5.3514200, 3.0120100, 0.4798550,
    0.0740339, 3.8949000, 2.5844300, 0.3735580, 0.8904320, 0.3238320, 0.2575550, 0.0000000,
    0.9342760, 0.0888360, 0.5568960, 0.9671300, 1.3869800, 0.1375050, 0.1332640, 0.3054340,
    0.8934960, 0.6831620, 0.1982210, 0.1037540, 0.3904820, 1.5452600, 0.3151240, 0.1741000,
    0.4041410, 4.2574600, 4.8540200, 0.9342760, 0.0000000, 1.1906300, 0.1713290, 0.4939050,
    1.5161200, 0.5157060, 0.4284370, 2.0584500, 0.2104940, 0.1027110, 0.0961621, 0.0467304,
    0.3980200, 0.0999208, 0.0811339, 0.0499310, 0.6793710, 1.0594700, 2.1151700, 0.0888360,
    1.1906300, 0.0000000, 0.1614440, 0.5459310, 0.1719030, 1.5296400, 6.4542800, 0.6498920,
    1.4385500, 0.6794890, 0.1950810, 0.4239840, 0.1094040, 0.9333720, 0.6823550, 0.2435700,
    0.6961980, 0.0999288, 0.4158440, 0.5568960, 0.1713290, 0.1614440, 0.0000000, 1.6132800,
    0.7953840, 0.1394050, 0.2160460, 0.3148870, 3.3707900, 1.2241900, 3.9742300, 1.0717600,
    1.4076600, 1.0288700, 0.7049390, 1.3418200, 0.7401690, 0.3194400, 0.3447390, 0.9671300,
    0.4939050, 0.5459310, 1.6132800, 0.0000000, 4.3780200, 0.5237420, 0.7869930, 0.2327390,
    2.1211100, 0.5544130, 2.0300600, 0.3748660, 0.5129840, 0.8579280, 0.8227650, 0.2258330,
    0.4733070, 1.4581600, 0.3266220, 1.3869800, 1.5161200, 0.1719030, 0.7953840, 4.3780200,
    0.0000000, 0.1108640, 0.2911480, 1.3882300, 0.1131330, 1.1639200, 0.0719167, 0.1297670,
    0.7170700, 0.2157370, 0.1565570, 0.3369830, 0.2625690, 0.2124830, 0.6653090, 0.1375050,
    0.5157060, 1.5296400, 0.1394050, 0.5237420, 0.1108640, 0.0000000, 2.4853900, 0.3653690,
    0.2407350, 0.3815330, 1.0860000, 0.3257110, 0.5438330, 0.2277100, 0.1963030, 0.1036040,
    3.8734400, 0.4201700, 0.3986180, 0.1332640, 0.4284370, 6.4542800, 0.2160460, 0.7869930,
    0.2911480, 2.4853900, 0.0000000, 0.3147300, 2.0060100, 0.2518490, 0.1962460, 0.1523350,
    1.0021400, 0.3012810, 0.5887310, 0.1872470, 0.1183580, 7.8213000, 1.8003400, 0.3054340,
    2.0584500, 0.6498920, 0.3148870, 0.2327390, 1.3882300, 0.3653690, 0.3147300, 0.0000000,
];

// WAG stationary frequencies from MrBayes
pub(crate) const WAG_PI: ProteinFrequencies = [
    0.08662790, 0.04397200, 0.03908940, 0.05704510, 0.01930780, 0.03672810, 0.05805890, 0.08325180,
    0.02443130, 0.04846600, 0.08620970, 0.06202860, 0.01950273, 0.03843190, 0.04576310, 0.06951790,
    0.06101270, 0.01438590, 0.03527420, 0.07089560,
];

// BLOSUM62 exchangeability matrix from MrBayes
pub(crate) const BLOSUM_EXCH: ProteinExch = [
    0.000000000000,
    0.735790389698,
    0.485391055466,
    0.543161820899,
    1.459995310470,
    1.199705704602,
    1.170949042800,
    1.955883574960,
    0.716241444998,
    0.605899003687,
    0.800016530518,
    1.295201266783,
    1.253758266664,
    0.492964679748,
    1.173275900924,
    4.325092687057,
    1.729178019485,
    0.465839367725,
    0.718206697586,
    2.187774522005,
    0.735790389698,
    0.000000000000,
    1.297446705134,
    0.500964408555,
    0.227826574209,
    3.020833610064,
    1.360574190420,
    0.418763308518,
    1.456141166336,
    0.232036445142,
    0.622711669692,
    5.411115141489,
    0.983692987457,
    0.371644693209,
    0.448133661718,
    1.122783104210,
    0.914665954563,
    0.426382310122,
    0.720517441216,
    0.438388343772,
    0.485391055466,
    1.297446705134,
    0.000000000000,
    3.180100048216,
    0.397358949897,
    1.839216146992,
    1.240488508640,
    1.355872344485,
    2.414501434208,
    0.283017326278,
    0.211888159615,
    1.593137043457,
    0.648441278787,
    0.354861249223,
    0.494887043702,
    2.904101656456,
    1.898173634533,
    0.191482046247,
    0.538222519037,
    0.312858797993,
    0.543161820899,
    0.500964408555,
    3.180100048216,
    0.000000000000,
    0.240836614802,
    1.190945703396,
    3.761625208368,
    0.798473248968,
    0.778142664022,
    0.418555732462,
    0.218131577594,
    1.032447924952,
    0.222621897958,
    0.281730694207,
    0.730628272998,
    1.582754142065,
    0.934187509431,
    0.145345046279,
    0.261422208965,
    0.258129289418,
    1.459995310470,
    0.227826574209,
    0.397358949897,
    0.240836614802,
    0.000000000000,
    0.329801504630,
    0.140748891814,
    0.418203192284,
    0.354058109831,
    0.774894022794,
    0.831842640142,
    0.285078800906,
    0.767688823480,
    0.441337471187,
    0.356008498769,
    1.197188415094,
    1.119831358516,
    0.527664418872,
    0.470237733696,
    1.116352478606,
    1.199705704602,
    3.020833610064,
    1.839216146992,
    1.190945703396,
    0.329801504630,
    0.000000000000,
    5.528919177928,
    0.609846305383,
    2.435341131140,
    0.236202451204,
    0.580737093181,
    3.945277674515,
    2.494896077113,
    0.144356959750,
    0.858570575674,
    1.934870924596,
    1.277480294596,
    0.758653808642,
    0.958989742850,
    0.530785790125,
    1.170949042800,
    1.360574190420,
    1.240488508640,
    3.761625208368,
    0.140748891814,
    5.528919177928,
    0.000000000000,
    0.423579992176,
    1.626891056982,
    0.186848046932,
    0.372625175087,
    2.802427151679,
    0.555415397470,
    0.291409084165,
    0.926563934846,
    1.769893238937,
    1.071097236007,
    0.407635648938,
    0.596719300346,
    0.524253846338,
    1.955883574960,
    0.418763308518,
    1.355872344485,
    0.798473248968,
    0.418203192284,
    0.609846305383,
    0.423579992176,
    0.000000000000,
    0.539859124954,
    0.189296292376,
    0.217721159236,
    0.752042440303,
    0.459436173579,
    0.368166464453,
    0.504086599527,
    1.509326253224,
    0.641436011405,
    0.508358924638,
    0.308055737035,
    0.253340790190,
    0.716241444998,
    1.456141166336,
    2.414501434208,
    0.778142664022,
    0.354058109831,
    2.435341131140,
    1.626891056982,
    0.539859124954,
    0.000000000000,
    0.252718447885,
    0.348072209797,
    1.022507035889,
    0.984311525359,
    0.714533703928,
    0.527007339151,
    1.117029762910,
    0.585407090225,
    0.301248600780,
    4.218953969389,
    0.201555971750,
    0.605899003687,
    0.232036445142,
    0.283017326278,
    0.418555732462,
    0.774894022794,
    0.236202451204,
    0.186848046932,
    0.189296292376,
    0.252718447885,
    0.000000000000,
    3.890963773304,
    0.406193586642,
    3.364797763104,
    1.517359325954,
    0.388355409206,
    0.357544412460,
    1.179091197260,
    0.341985787540,
    0.674617093228,
    8.311839405458,
    0.800016530518,
    0.622711669692,
    0.211888159615,
    0.218131577594,
    0.831842640142,
    0.580737093181,
    0.372625175087,
    0.217721159236,
    0.348072209797,
    3.890963773304,
    0.000000000000,
    0.445570274261,
    6.030559379572,
    2.064839703237,
    0.374555687471,
    0.352969184527,
    0.915259857694,
    0.691474634600,
    0.811245856323,
    2.231405688913,
    1.295201266783,
    5.411115141489,
    1.593137043457,
    1.032447924952,
    0.285078800906,
    3.945277674515,
    2.802427151679,
    0.752042440303,
    1.022507035889,
    0.406193586642,
    0.445570274261,
    0.000000000000,
    1.073061184332,
    0.266924750511,
    1.047383450722,
    1.752165917819,
    1.303875200799,
    0.332243040634,
    0.717993486900,
    0.498138475304,
    1.253758266664,
    0.983692987457,
    0.648441278787,
    0.222621897958,
    0.767688823480,
    2.494896077113,
    0.555415397470,
    0.459436173579,
    0.984311525359,
    3.364797763104,
    6.030559379572,
    1.073061184332,
    0.000000000000,
    1.773855168830,
    0.454123625103,
    0.918723415746,
    1.488548053722,
    0.888101098152,
    0.951682162246,
    2.575850755315,
    0.492964679748,
    0.371644693209,
    0.354861249223,
    0.281730694207,
    0.441337471187,
    0.144356959750,
    0.291409084165,
    0.368166464453,
    0.714533703928,
    1.517359325954,
    2.064839703237,
    0.266924750511,
    1.773855168830,
    0.000000000000,
    0.233597909629,
    0.540027644824,
    0.488206118793,
    2.074324893497,
    6.747260430801,
    0.838119610178,
    1.173275900924,
    0.448133661718,
    0.494887043702,
    0.730628272998,
    0.356008498769,
    0.858570575674,
    0.926563934846,
    0.504086599527,
    0.527007339151,
    0.388355409206,
    0.374555687471,
    1.047383450722,
    0.454123625103,
    0.233597909629,
    0.000000000000,
    1.169129577716,
    1.005451683149,
    0.252214830027,
    0.369405319355,
    0.496908410676,
    4.325092687057,
    1.122783104210,
    2.904101656456,
    1.582754142065,
    1.197188415094,
    1.934870924596,
    1.769893238937,
    1.509326253224,
    1.117029762910,
    0.357544412460,
    0.352969184527,
    1.752165917819,
    0.918723415746,
    0.540027644824,
    1.169129577716,
    0.000000000000,
    5.151556292270,
    0.387925622098,
    0.796751520761,
    0.561925457442,
    1.729178019485,
    0.914665954563,
    1.898173634533,
    0.934187509431,
    1.119831358516,
    1.277480294596,
    1.071097236007,
    0.641436011405,
    0.585407090225,
    1.179091197260,
    0.915259857694,
    1.303875200799,
    1.488548053722,
    0.488206118793,
    1.005451683149,
    5.151556292270,
    0.000000000000,
    0.513128126891,
    0.801010243199,
    2.253074051176,
    0.465839367725,
    0.426382310122,
    0.191482046247,
    0.145345046279,
    0.527664418872,
    0.758653808642,
    0.407635648938,
    0.508358924638,
    0.301248600780,
    0.341985787540,
    0.691474634600,
    0.332243040634,
    0.888101098152,
    2.074324893497,
    0.252214830027,
    0.387925622098,
    0.513128126891,
    0.000000000000,
    4.054419006558,
    0.266508731426,
    0.718206697586,
    0.720517441216,
    0.538222519037,
    0.261422208965,
    0.470237733696,
    0.958989742850,
    0.596719300346,
    0.308055737035,
    4.218953969389,
    0.674617093228,
    0.811245856323,
    0.717993486900,
    0.951682162246,
    6.747260430801,
    0.369405319355,
    0.796751520761,
    0.801010243199,
    4.054419006558,
    0.000000000000,
    1.000000000000,
    2.187774522005,
    0.438388343772,
    0.312858797993,
    0.258129289418,
    1.116352478606,
    0.530785790125,
    0.524253846338,
    0.253340790190,
    0.201555971750,
    8.311839405458,
    2.231405688913,
    0.498138475304,
    2.575850755315,
    0.838119610178,
    0.496908410676,
    0.561925457442,
    2.253074051176,
    0.266508731426,
    1.000000000000,
    0.000000000000,
];

// BLOSUM62 stationary frequencies from MrBayes
pub(crate) const BLOSUM_PI: ProteinFrequencies = [
    0.074, 0.052, 0.045, 0.054, 0.025, 0.034, 0.054, 0.074, 0.026, 0.068, 0.099, 0.058, 0.025,
    0.047, 0.039, 0.057, 0.051, 0.013, 0.032, 0.073,
];

// HIVB exchangeability matrix from PhyML
// The code only contains the lower triangle of the matrix, the rest is symmetric
pub(crate) const HIVB_EXCH_LOWER_TRIAG: ProteinExchLowerTriangle = [
    0.307507000000,
    0.005000000000,
    0.295543000000,
    1.455040000000,
    0.005000000000,
    17.661200000000,
    0.123758000000,
    0.351721000000,
    0.086064200000,
    0.005000000000,
    0.055112800000,
    3.421500000000,
    0.672052000000,
    0.005000000000,
    0.005000000000,
    1.481350000000,
    0.074921800000,
    0.079263300000,
    10.587200000000,
    0.005000000000,
    2.560200000000,
    2.135360000000,
    3.653450000000,
    0.323401000000,
    2.838060000000,
    0.897871000000,
    0.061913700000,
    3.927750000000,
    0.084761300000,
    9.040440000000,
    7.645850000000,
    1.916900000000,
    0.240073000000,
    7.055450000000,
    0.119740000000,
    0.005000000000,
    0.005000000000,
    0.677289000000,
    0.680565000000,
    0.017679200000,
    0.005000000000,
    0.005000000000,
    0.006090790000,
    0.005000000000,
    0.103111000000,
    0.215256000000,
    0.701427000000,
    0.005000000000,
    0.008760480000,
    0.129777000000,
    1.494560000000,
    0.005000000000,
    0.005000000000,
    1.741710000000,
    5.958790000000,
    0.005000000000,
    20.450000000000,
    7.904430000000,
    0.005000000000,
    0.005000000000,
    6.547370000000,
    4.614820000000,
    0.521705000000,
    0.005000000000,
    0.322319000000,
    0.081499500000,
    0.018664300000,
    2.513940000000,
    0.005000000000,
    0.005000000000,
    0.005000000000,
    0.303676000000,
    0.175789000000,
    0.005000000000,
    0.005000000000,
    11.206500000000,
    5.319610000000,
    1.282460000000,
    0.014126900000,
    0.005000000000,
    0.005000000000,
    0.005000000000,
    9.298150000000,
    0.005000000000,
    0.005000000000,
    0.291561000000,
    0.145558000000,
    3.398360000000,
    8.524840000000,
    0.034265800000,
    0.188025000000,
    2.122170000000,
    1.283550000000,
    0.007395780000,
    0.034265800000,
    0.005000000000,
    4.472110000000,
    0.012022600000,
    0.005000000000,
    2.453180000000,
    0.041059300000,
    2.077570000000,
    0.031386200000,
    0.005000000000,
    0.005000000000,
    2.466330000000,
    3.479100000000,
    13.144700000000,
    0.528230000000,
    4.693140000000,
    0.116311000000,
    0.005000000000,
    4.380410000000,
    0.382747000000,
    1.218030000000,
    0.927656000000,
    0.504111000000,
    0.005000000000,
    0.956472000000,
    5.377620000000,
    15.918300000000,
    2.868680000000,
    6.886670000000,
    0.274724000000,
    0.739969000000,
    0.243589000000,
    0.289774000000,
    0.369615000000,
    0.711594000000,
    8.612170000000,
    0.043767300000,
    4.671420000000,
    4.940260000000,
    0.014126900000,
    2.014170000000,
    8.931070000000,
    0.005000000000,
    0.991338000000,
    0.005000000000,
    0.005000000000,
    2.632770000000,
    0.026656000000,
    0.005000000000,
    1.216740000000,
    0.069517900000,
    0.005000000000,
    0.748843000000,
    0.005000000000,
    0.089078000000,
    0.829343000000,
    0.044450600000,
    0.024872800000,
    0.005000000000,
    0.005000000000,
    0.009918260000,
    1.764170000000,
    0.674653000000,
    7.579320000000,
    0.113033000000,
    0.079263300000,
    0.005000000000,
    18.694300000000,
    0.148168000000,
    0.111986000000,
    0.005000000000,
    0.005000000000,
    15.340000000000,
    0.030438100000,
    0.648024000000,
    0.105652000000,
    1.280220000000,
    7.614280000000,
    0.081245400000,
    0.026656000000,
    1.047930000000,
    0.420027000000,
    0.020915300000,
    1.028470000000,
    0.953155000000,
    0.005000000000,
    17.738900000000,
    1.410360000000,
    0.265829000000,
    6.853200000000,
    0.723274000000,
    0.005000000000,
    0.074921800000,
    0.709226000000,
    0.005000000000,
    0.041059300000,
];

// HIVB stationary frequencies from PhyML
pub(crate) const HIVB_PI: ProteinFrequencies = [
    0.060490222,
    0.066039665,
    0.044127815,
    0.042109048,
    0.020075899,
    0.053606488,
    0.071567447,
    0.072308239,
    0.022293943,
    0.069730629,
    0.098851122,
    0.056968211,
    0.019768318,
    0.028809447,
    0.046025282,
    0.05060433,
    0.053636813,
    0.033011601,
    0.028350243,
    0.061625237,
];
